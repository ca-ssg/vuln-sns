id: vuln-sns-avatar-authorization-bypass
info:
  name: Vuln SNS Avatar - Authorization Bypass
  author: claude
  severity: high
  description: |
    Tests for authorization bypass in avatar upload endpoint.
  reference:
    - https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/05-Authorization_Testing/
  tags: vuln-sns,authorization,avatar

http:
  - method: POST
    path:
      - "{{BaseURL}}/api/profile/avatar"
    headers:
      Content-Type: application/json
      Authorization: "Bearer {{token}}"
    body: |
      {
        "file_id": "test.jpg",
        "image_data": "iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg=="
      }

    payloads:
      token:
        - "invalid_token"
        - ""
        - "fake_token"

    matchers:
      - type: word
        words:
          - "avatar_data"
          - "malware_scan"
        condition: and
        part: body