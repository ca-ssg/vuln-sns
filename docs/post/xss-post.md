# 投稿表示機能のXSS

## 脆弱性の説明
投稿内容の表示にv-htmlディレクティブを使用しているため、クロスサイトスクリプティング（XSS）が可能です。

## 影響範囲
- 悪意のあるスクリプトの実行
- ユーザーセッションの盗取
- 不正な操作の実行

## 攻撃方法と手順

### 1. 基本的なXSS攻撃

1. アプリケーションにログインします
2. 投稿作成フォームにアクセスします
3. 投稿内容フィールドに以下のXSSペイロードを入力します：
   ```html
   <img src=x onerror="alert(1)">
   ```
4. 投稿ボタンをクリックします
5. 投稿一覧ページに移動すると、アラートダイアログが表示されます

※もし、画面リロードしてもアラートダイアログが表示されない場合は、別タブで開いてみてください。

### 2. クッキー盗取攻撃

1. アプリケーションにログインします
2. 投稿作成フォームにアクセスします
3. 投稿内容フィールドに以下のXSSペイロードを入力します：
   ```html
   <svg onload=alert(document.cookie)>
   ```
   または
   ```html
   <img src=x onerror=alert(localStorage.getItem(\"token\"))>
   ```
4. 投稿ボタンをクリックします
5. 画面を更新してみてください

※もし、画面リロードしてもアラートダイアログが表示されない場合は、別タブで開いてみてください。

このペイロードは、ユーザーのクッキーやローカルストレージに保存されたトークンを表示させるだけです。
もう少し悪用しようと思うと攻撃者のサーバーに送信することも可能です。
実際の攻撃では、攻撃者が制御するサーバーにユーザーのTokenなどのパラメータを付加して送信されます。


## 対策方法
### 1. v-htmlの代わりにv-textを使用（推奨）
```vue
<!-- 修正前（脆弱なコード） -->
<template>
  <div v-html="post.content"></div>
</template>

<!-- 修正後（安全なコード） -->
<template>
  <div v-text="post.content"></div>
</template>
```

### 2. サニタイズ
```vue
<!-- 修正前（脆弱なコード） -->
<template>
  <div v-html="post.content"></div>
</template>

<!-- 修正後（安全なコード） -->
<template>
  <div v-html="sanitizedContent"></div>
</template>
```
